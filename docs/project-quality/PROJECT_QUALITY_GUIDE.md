# H∆∞·ªõng D·∫´n X·ª≠ L√Ω V·∫•n ƒê·ªÅ Project Quality

## üìä T√¨nh Tr·∫°ng Hi·ªán T·∫°i

### ‚úÖ ƒê√£ Gi·∫£i Quy·∫øt

- **CSpell**: ‚úÖ 0 l·ªói (t·ª´ 893 l·ªói)
- **TypeScript**: ‚úÖ Compilation th√†nh c√¥ng
- **Unused Dependencies**: ‚úÖ ƒê√£ x√≥a axios, fs-extra kh·ªèi nexo-native
- **Environment Variables**: ‚úÖ ƒê√£ gi·∫£i quy·∫øt warnings v·ªÅ VITE*SUPABASE*\*
- **Lockfile Sync**: ‚úÖ ƒê√£ sync pnpm-lock.yaml v·ªõi package.json changes

### ‚ö†Ô∏è C·∫ßn Theo D√µi (Warnings - Kh√¥ng Fail Build)

- **Circular Dependencies**: ~2300 warnings (ch·ªß y·∫øu t·ª´ build output)
- **Dependencies**: Warnings nh·ªè v·ªÅ package dependencies
- **Build Compatibility**: Warnings v·ªÅ node modules externalization

---

## üîß Environment Variables (M·ªõi Gi·∫£i Quy·∫øt)

### V·∫•n ƒê·ªÅ Tr∆∞·ªõc ƒê√¢y

Trong qu√° tr√¨nh build, c√≥ warnings:

```
[warn] - VITE_SUPABASE_URL
[warn] - VITE_SUPABASE_ANON_KEY
```

### ‚úÖ Gi·∫£i Ph√°p ƒê√£ √Åp D·ª•ng

1. **T·∫°o root `.env` file** v·ªõi default values:

```bash
# .env (root level)
VITE_SUPABASE_URL=
VITE_SUPABASE_ANON_KEY=
```

2. **Environment hierarchy**:
   - Apps c√≥ `.env.local` v·ªõi values th·∫≠t
   - Root c√≥ `.env` v·ªõi default values cho packages
   - Build warnings ƒë√£ bi·∫øn m·∫•t ‚úÖ

3. **Chi ti·∫øt**: Xem [ENV_VARS_RESOLUTION.md](./ENV_VARS_RESOLUTION.md)

---

## üîÑ Circular Dependencies

### Hi·ªÉu v·ªÅ Circular Dependencies

Circular dependencies trong project n√†y **KH√îNG ph·∫£i l·ªói nghi√™m tr·ªçng** v√¨:

1. **Ch·ªß y·∫øu t·ª´ build output**: `apps/nexo-native/out/renderer/js/**`
2. **Webpack/Vite build process**: Tool bundler t·ª± ƒë·ªông x·ª≠ l√Ω
3. **Runtime ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng**: Application ch·∫°y kh√¥ng v·∫•n ƒë·ªÅ
4. **Kh√¥ng block CI/CD**: Build v√† deployment v·∫´n th√†nh c√¥ng

### Monitoring Commands

```bash
# Xem circular dependencies chi ti·∫øt
pnpm run check:circular

# Ch·ªâ count s·ªë l∆∞·ª£ng (nhanh h∆°n)
pnpm run check:circular | grep "Circular dependency" | wc -l
```

### Khi N√†o C·∫ßn Quan T√¢m?

- **Circular trong source code** (kh√¥ng ph·∫£i build output)
- **Runtime errors** li√™n quan ƒë·∫øn module loading
- **Performance issues** do circular dependencies

### C√°ch Gi·∫£i Quy·∫øt (Khi C·∫ßn)

1. **Identify source-level circulars**:

```bash
# Check source files ch·ªâ
pnpm run check:circular | grep -v "/out/" | grep -v "/dist/"
```

2. **Common patterns ƒë·ªÉ s·ª≠a**:
   - Extract shared types/interfaces
   - Use dependency injection
   - Refactor module structure

---

## üì¶ Dependency Management

### Ki·ªÉm Tra Dependencies

```bash
# Xem dependencies kh√¥ng s·ª≠ d·ª•ng
pnpm run check:dep

# Xem dependencies v√† c√°ch s·ª≠ d·ª•ng
pnpm list --depth=0
```

### Best Practices

1. **Regular cleanup**: Monthly review dependencies
2. **Use catalog versions**: ∆Øu ti√™n s·ª≠ d·ª•ng catalog trong pnpm-workspace
3. **Avoid dev in prod**: ƒê·∫£m b·∫£o dev dependencies kh√¥ng leak v√†o production

---

## üî§ CSpell Dictionary Management

### Th√™m T·ª´ Ti·∫øng Vi·ªát M·ªõi

Khi g·∫∑p l·ªói cspell v·ªõi t·ª´ ti·∫øng Vi·ªát h·ª£p l·ªá:

1. **M·ªü file cspell.json**
2. **Th√™m t·ª´ v√†o m·∫£ng `words`**:

```json
{
  "words": [
    // ... existing words
    "t·ª´_m·ªõi_ti·∫øng_vi·ªát"
  ]
}
```

3. **Ch·∫°y ki·ªÉm tra**:

```bash
pnpm run check:cspell
```

### Ph√¢n Lo·∫°i T·ª´ (Tham Kh·∫£o)

- **Technical**: ƒê·ªãnh, nghƒ©a, li·ªáu, d·ª•ng, thi·∫øt, k·∫ø
- **UI/UX**: tho·∫°i, ng∆∞·ªùi, d√πng, ch·ªçn, hi·ªÉn, th·ªã
- **Actions**: Kh·ªüi, ƒë·ªông, Ch·∫°y, k√≠ch, ho·∫°t, ki·ªÉm, tra
- **Status**: ho√†n, th√†nh, ƒë∆∞·ª£c, Kh√¥ng, th√†nh, c√¥ng

### Khi C√≥ Nhi·ªÅu T·ª´ Ti·∫øng Vi·ªát

Thay v√¨ th√™m nhi·ªÅu t·ª´, xem x√©t th√™m file v√†o `ignorePaths`:

```json
{
  "ignorePaths": ["path/to/vietnamese-heavy-file/**"]
}
```

---

## üöÄ Daily Workflow

### Tr∆∞·ªõc Khi Commit

```bash
# Quick check (nhanh)
pnpm run check:type && pnpm run check:cspell

# Full check (ƒë·∫ßy ƒë·ªß)
pnpm check
```

### Gi·∫£i Quy·∫øt L·ªói Th∆∞·ªùng G·∫∑p

#### Environment Variables

```bash
# N·∫øu thi·∫øu env vars trong packages
# 1. Th√™m v√†o root .env v·ªõi default value
# 2. Ho·∫∑c th√™m v√†o apps/*/env v·ªõi real value

# Check env loading
node -e "console.log(require('dotenv').config())"
```

#### CSpell Errors

```bash
# N·∫øu c√≥ t·ª´ ti·∫øng Vi·ªát h·ª£p l·ªá
# 1. Th√™m v√†o cspell.json words array
# 2. Ho·∫∑c th√™m file v√†o ignorePaths n·∫øu c√≥ nhi·ªÅu ti·∫øng Vi·ªát

# N·∫øu c√≥ typo ti·∫øng Anh
# 1. S·ª≠a typo trong code
# 2. Ho·∫∑c th√™m t·ª´ chuy√™n m√¥n v√†o words array
```

#### TypeScript Errors

```bash
# Compile errors
pnpm run check:type

# Auto-fix style issues
pnpm run lint:fix
```

---

## üìà Metrics & Monitoring

### Quality Metrics Dashboard

```bash
# Spell check status
echo "CSpell: $(pnpm run check:cspell 2>&1 | grep -o 'Issues found: [0-9]*' || echo '‚úÖ PASS')"

# TypeScript status
echo "TypeScript: $(pnpm run check:type > /dev/null 2>&1 && echo '‚úÖ PASS' || echo '‚ùå FAIL')"

# Circular dependencies count
echo "Circulars: $(pnpm run check:circular 2>&1 | grep -c 'Circular dependency' || echo '0') warnings"

# Environment variables status
echo "Env Vars: $(pnpm turbo build --filter='@vben-core/form-ui' 2>&1 | grep -c 'VITE_SUPABASE' || echo '‚úÖ CLEAN')"
```

### Available Scripts

```bash
# Quality checks
pnpm check                    # Full quality check
pnpm run check:type          # TypeScript only
pnpm run check:cspell        # Spell check only
pnpm run check:circular      # Circular deps only
pnpm run check:dep           # Dependencies only
pnpm run check:quick         # Fast check (type + cspell)

# Development
pnpm dev                     # Start development
pnpm build                   # Build production
pnpm lint                    # Lint code
pnpm format                  # Format code
```

---

## üéØ Goals & Targets

### ‚úÖ Completed (October 2025)

- **CSpell**: 0 errors (t·ª´ 893 l·ªói)
- **TypeScript**: No compilation errors
- **Unused deps**: Cleaned nexo-native
- **Environment Variables**: No more VITE*SUPABASE*\* warnings

### üéØ Short Term (1-2 tu·∫ßn)

- Build compatibility warnings (jiti, node modules)
- Performance optimization
- Documentation updates

### üéØ Medium Term (1-2 th√°ng)

- Circular deps: Gi·∫£m xu·ªëng d∆∞·ªõi 1000 (t·ª´ 2300+)
- Performance: Monitor build time v√† bundle size
- Dependencies: Standardize versions across packages

### üéØ Long Term (3-6 th√°ng)

- Zero source-level circular dependencies
- Automated quality gates in CI/CD
- Performance budgets v√† monitoring

---

## üõ†Ô∏è Recent Improvements

### Environment Variables Resolution

- **Problem**: Build warnings v·ªÅ missing VITE*SUPABASE*\* variables
- **Solution**: Root `.env` file v·ªõi default values
- **Result**: Clean build logs, no more env warnings
- **Documentation**: [ENV_VARS_RESOLUTION.md](./ENV_VARS_RESOLUTION.md)

### Dictionary Management

- **Vietnamese Support**: Complete bilingual spell checking
- **Custom Dictionary**: 100+ Vietnamese technical terms
- **Documentation**: [VIETNAMESE_DICTIONARY.md](./VIETNAMESE_DICTIONARY.md)

### Dependency Cleanup

- **Removed**: axios, fs-extra, @types/fs-extra t·ª´ nexo-native
- **Result**: Cleaner dependency tree, no unused warnings
- **Method**: Manual audit v√† validation

---

## üß∞ Tools & Utilities

### Useful Aliases (Optional)

Th√™m v√†o shell profile (.bashrc, .zshrc):

```bash
alias pcheck="pnpm check"
alias ptype="pnpm run check:type"
alias pspell="pnpm run check:cspell"
alias pcircular="pnpm run check:circular"
alias pquick="pnpm run check:quick"
```

### Debugging Scripts

```bash
# Environment debugging
function check-env() {
  echo "=== Root .env ==="
  cat .env 2>/dev/null || echo "No root .env found"
  echo -e "\n=== App .env.local ==="
  cat apps/nexo-web/.env.local 2>/dev/null || echo "No app .env.local found"
}

# Quality summary
function quality-summary() {
  echo "üìä Project Quality Summary:"
  echo "TypeScript: $(pnpm run check:type > /dev/null 2>&1 && echo '‚úÖ PASS' || echo '‚ùå FAIL')"
  echo "CSpell: $(pnpm run check:cspell > /dev/null 2>&1 && echo '‚úÖ PASS' || echo '‚ùå FAIL')"
  echo "Circular Deps: $(pnpm run check:circular 2>&1 | grep -c 'Circular dependency' || echo '0') warnings"
}
```

---

## ÔøΩ Lockfile Management

### V·∫•n ƒê·ªÅ Lockfile Sync

Khi x√≥a dependencies t·ª´ package.json, c·∫ßn update lockfile:

#### L·ªói CI/CD

```bash
ERR_PNPM_OUTDATED_LOCKFILE Cannot install with "frozen-lockfile"
because pnpm-lock.yaml is not up to date with package.json

* 3 dependencies were removed: axios@^1.11.0, fs-extra@^11.3.1, @types/fs-extra@^11.0.4
```

#### ‚úÖ Gi·∫£i Ph√°p

```bash
# Update lockfile sau khi thay ƒë·ªïi dependencies
pnpm install

# Test frozen lockfile (nh∆∞ CI/CD)
pnpm install --frozen-lockfile
```

#### Best Practices

1. **Sau khi remove dependencies**: Lu√¥n ch·∫°y `pnpm install`
2. **Tr∆∞·ªõc khi commit**: Test v·ªõi `pnpm install --frozen-lockfile`
3. **CI/CD ready**: ƒê·∫£m b·∫£o lockfile sync v·ªõi package.json

---

## ÔøΩüìö Resources & Documentation

### Project Files

- `cspell.json` - Spell checking configuration v·ªõi Vietnamese support
- `VIETNAMESE_DICTIONARY.md` - Vietnamese dictionary management guide
- `ENV_VARS_RESOLUTION.md` - Environment variables setup v√† troubleshooting
- `CSPELL_RESOLUTION_SUMMARY.md` - Chi ti·∫øt qu√° tr√¨nh gi·∫£i quy·∫øt cspell issues
- `.env` - Root environment variables v·ªõi default values
- `pnpm-lock.yaml` - Dependency lockfile (auto-generated, commit required)

### External Links

- [CSpell Configuration](https://cspell.org/configuration/)
- [TypeScript Configuration](https://www.typescriptlang.org/tsconfig)
- [PNPM Workspace](https://pnpm.io/workspaces)
- [Vite Environment Variables](https://vitejs.dev/guide/env-and-mode.html)
- [PNPM Lockfile](https://pnpm.io/pnpm-lock)

---

## üìù Change Log

### 2025-10-07

- ‚úÖ Resolved environment variables warnings
- ‚úÖ Created root `.env` file with defaults
- ‚úÖ Updated documentation v·ªõi environment setup guide
- ‚úÖ Tested package builds - no more VITE*SUPABASE*\* warnings
- ‚úÖ Fixed pnpm lockfile sync issue (removed dependencies)
- ‚úÖ CI/CD ready - frozen lockfile passes
- üìã Next: Address build compatibility warnings (jiti, node modules)
